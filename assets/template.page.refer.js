!function(e){function r(r){for(var l,n,i=r[0],o=r[1],d=r[2],u=0,c=[];u<i.length;u++)n=i[u],a[n]&&c.push(a[n][0]),a[n]=0;for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l]);for(f&&f(r);c.length;)c.shift()();return s.push.apply(s,d||[]),t()}function t(){for(var e,r=0;r<s.length;r++){for(var t=s[r],l=!0,i=1;i<t.length;i++){var o=t[i];0!==a[o]&&(l=!1)}l&&(s.splice(r--,1),e=n(n.s=t[0]))}return e}var l={},a={9:0},s=[];function n(r){if(l[r])return l[r].exports;var t=l[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=l,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var l in e)n.d(t,l,function(r){return e[r]}.bind(null,l));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="";var i=window.shopifySlateJsonp=window.shopifySlateJsonp||[],o=i.push.bind(i);i.push=r,i=i.slice();for(var d=0;d<i.length;d++)r(i[d]);var f=o;s.push([529,0]),t()}({259:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.get=void 0;var l=function(e){return e&&e.__esModule?e:{default:e}}(t(71)),a=document.querySelector("[data-swell-i18n]");a&&(a=JSON.parse(a.innerHTML)),r.get=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=(0,l.default)(a,e);return t||r}},529:function(e,r,t){"use strict";var l=d(t(9)),a=d(t(12)),s=d(t(6)),n=t(259),i=d(t(530)),o=d(t(531));function d(e){return e&&e.__esModule?e:{default:e}}var f=new(function(){function e(r,t){(0,l.default)(this,e),this.referralFormsData=r,this.shareLinks=t}return(0,a.default)(e,[{key:"renderReferralForm",value:function(e,r){(0,s.default)(".swell-referral").append((0,s.default)("<form>").addClass(e.formType).append((0,s.default)("<h3>").text(e.title).addClass("swell-form-title mb-3"),(0,s.default)("<label>").html(e.explain).addClass("explain-text"),(0,s.default)('<div class="form-fields">').append((0,s.default)('<input autofocus type="'+e.inputType+'" placeholder="'+e.placeholder+'" class="swell-input-text" />'),(0,s.default)("<input>",{type:"submit",value:e.submitText,class:"form-btn "+e.class}))).addClass("hidden-form").submit(function(e){r(e)})),"existing"===e.formType&&this.renderShareLinks(e.formType),(0,s.default)(".swell-spinner").remove()}},{key:"renderShareLinks",value:function(){(0,s.default)(".swell-referral-copy-links").append((0,s.default)("<div>").addClass("swell-copyLink-div pt-3 pb-6").append((0,s.default)('<div class="form-fields">').append((0,s.default)('<label for="reward-field" class="swell-referral-copy-links__label">').text(i.default.referralForms.existingUserForm.shareFormLabel),(0,s.default)('<input id="reward-field" type="text" readonly class="p-link share-field swell-input-text swell-input-text--no-border">',{value:swellAPI.getCustomerDetails().referralLink}),(0,s.default)("<button>",{type:"button",text:i.default.referralForms.existingUserForm.shareFormButtonText,class:"copyLink relative form-btn","data-copied-text":i.default.referralForms.existingUserForm.shareFormCopiedText,id:"referral-copy-button"}).click(function(){var e=swellAPI.getCustomerDetails().referralLink;navigator.clipboard?navigator.clipboard.writeText(e):document.execCommand("copy",!1,e);var r=document.getElementById("referral-copy-button");r.classList.add("button-clicked"),setTimeout(function(){r.classList.remove("button-clicked")},7e3)})))),(0,s.default)(".swell-referral-copy-links").append((0,s.default)("<div>").addClass("swell-share-links-container")),(0,s.default)(".swell-share-links-container").append((0,s.default)("<ul>").addClass("share-link-list")),this.shareLinks.forEach(function(e){(0,s.default)(".share-link-list").append((0,s.default)("<li>").addClass("swell-share-link-li").append((0,s.default)("<i>").addClass(e.icon).addClass("icons").addClass(e.class),(0,s.default)("<a>",{href:e.href,text:e.text}).addClass("swell-share-link").addClass(e.class)).addClass("SMS"==e.text?"hidden-sms":""))})}},{key:"copyLinkPath",value:function(){(0,s.default)(".p-link").val(swellAPI.getCustomerDetails().referralLink)}},{key:"showReferralForm",value:function(){this.renderReferralForm(this.referralFormsData.newUserForm,this.onClientEmailSubmit),this.renderReferralForm(this.referralFormsData.existingUserForm,this.onFriendEmailSubmit),setTimeout(function(){(0,s.default)(".showing-form .swell-input-text").focus()},15)}},{key:"revealForm",value:function(e,r,t){void 0===e.email?(0,s.default)("."+r).addClass("showing-form"):((0,s.default)("."+t).addClass("showing-form"),(0,s.default)(".swell-referral-copy-links").removeClass("hidden-div").addClass("showing-div"),(0,s.default)(".showing-form .swell-input-text").focus())}},{key:"onClientEmailSubmit",value:function(e){e.preventDefault();var r=(0,s.default)("form.new input");swellAPI.identifyReferrer(r.val(),function(){(0,s.default)(".p-link").val(swellAPI.getCustomerDetails().referralLink),(0,s.default)(".swell-form-error").remove(),(0,s.default)("form.new").removeClass("showing-form").addClass("hidden-form"),(0,s.default)("form.existing").removeClass("hidden-form").addClass("showing-form"),(0,s.default)(".swell-referral-copy-links").removeClass("hidden-div").addClass("showing-div")},function(){(0,s.default)(".swell-form-error").remove(),(0,s.default)("form.new").append((0,s.default)('<p class="swell-form-error">').html((0,n.get)("refer.errors.invalid_email","Please enter a valid email address")))})}},{key:"onFriendEmailSubmit",value:function(e){e.preventDefault();var r=(0,s.default)("form.existing input").val().split(",");swellAPI.sendReferralEmails(r,function(){(0,s.default)(".swell-form-error").remove(),(0,s.default)("form.existing").removeClass("showing-form").addClass("hidden-form"),(0,s.default)(".swell-referral-copy-links").hide(),(0,s.default)(".swell-referral").append((0,s.default)("<div>").addClass("swell-success-confirmation").append((0,s.default)("<h3>").text(i.default.referralForms.existingUserForm.success.title).addClass("w-full pb-3"),(0,s.default)("<p>").html(i.default.referralForms.existingUserForm.success.excerpt_html).addClass("success-message"),(0,s.default)("<button>").text(i.default.referralForms.existingUserForm.success.button_text).addClass("form-btn").click(function(){(0,s.default)(".swell-success-confirmation").remove(),(0,s.default)(".swell-referral-copy-links").show(),(0,s.default)("#reward-field").val(swellAPI.getCustomerDetails().referralLink),(0,s.default)("form.existing").removeClass("hidden-form").addClass("showing-form")}))),(0,s.default)(".swell-input-text").val(""),(0,s.default)(".swell-referral-history").empty(),swellAPI.refreshCustomerDetails(),setTimeout(function(){new o.default(swellAPI.getCustomerDetails()).renderReferralHistory()},1e3)},function(e){(0,s.default)(".swell-form-error").remove(),"EMAILS_ALREADY_PURCHASED"==e.message&&(console.log(e.message,(0,n.get)("refer.errors")),e.message=(0,n.get)("refer.errors.emails_already_purchased")),(0,s.default)("form.existing").append((0,s.default)("<p>").text(e.message).addClass("swell-form-error"))})}}]),e}())(i.default.referralForms,i.default.referralShareLinks);(0,s.default)(window).on("load",function(){(function(){(0,s.default)(document).ready(function(){(0,s.default)(document).on("swell:initialized",function(){f.showReferralForm()}),(0,s.default)(document).one("swell:setup",function(){f.copyLinkPath(),f.revealForm(swellAPI.getCustomerDetails(),i.default.referralForms.newUserForm.formType,i.default.referralForms.existingUserForm.formType),swellAPI.getCustomerDetails().referrals.length>0&&new o.default(swellAPI.getCustomerDetails()).renderReferralHistory()})})}).call(void 0)})},530:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=t(259);r.default={referralForms:{newUserForm:{inputType:"text",submitText:(0,l.get)("refer.new_user.button_text","Next"),placeholder:"",formType:"new",title:(0,l.get)("refer.new_user.form_header","Share KATEFARMS"),explain:(0,l.get)("refer.new_user.field_label","Enter your email to get started"),class:"blue"},existingUserForm:{inputType:"text",submitText:"Send",placeholder:"",formType:"existing",title:(0,l.get)("refer.existing_user.form_header","Share Kate Farms"),explain:(0,l.get)("refer.existing_user.field_label","Friend's email address"),subLabel:(0,l.get)("refer.existing_user.field_sublabel","Separate multiple email addresses with a comma"),class:"blue",shareFormLabel:(0,l.get)("refer.existing_user.share_form.label","Post or share your referral link anywhere"),shareFormButtonText:(0,l.get)("refer.existing_user.share_form.button_text","Copy link"),shareFormCopiedText:(0,l.get)("refer.existing_user.share_form.copied_text","Link copied!"),success:{title:(0,l.get)("refer.existing_user.success.title","Thank you for sharing Kate Farms"),excerpt_html:(0,l.get)("refer.existing_user.success.excerpt_html",'Refer another friend, or <a class="underline" href="/" title="visit the shop">visit the shop</a>'),button_text:(0,l.get)("refer.existing_user.success.button_text","Refer another friend")}}},referralShareLinks:[{class:"swell-share-referral-facebook",href:"javascript:void(0)",icon:"icon icon-facebook",text:"Facebook"},{class:"swell-share-referral-sms",href:"javascript:void(0)",icon:"far fa-comment-alt",text:"SMS"},{class:"swell-share-referral-messenger",href:"javascript:void(0)",icon:"icon icon-facebook-messenger",text:"Facebook Messenger"},{class:"swell-share-referral-twitter",href:"javascript:void(0)",icon:"icon icon-twitter",text:"Twitter"}]}},531:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=n(t(9)),a=n(t(12)),s=n(t(6));function n(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(r){(0,l.default)(this,e),this.customer=r,this.centsPerPoint=.1}return(0,a.default)(e,[{key:"renderReferralHistory",value:function(){var e=swellAPI.getCustomerDetails();(0,s.default)(".swell-point-balance-dollar").text("$"+e.pointsBalance*this.centsPerPoint+" "),e.pointsBalance>0&&(0,s.default)(".swell-referral-history-div").removeClass("hidden-div").addClass("showing-div"),(0,s.default)(".swell-referral-back").css("margin","2% 0 3% 0"),(0,s.default)(".swell-referral-history").append((0,s.default)("<table>").addClass("swell-referral-history-table").append((0,s.default)("<thead>").append((0,s.default)("<tr>").append((0,s.default)("<td>").text("Email"),(0,s.default)("<td>").text("Status"))),(0,s.default)("<tbody>"))),this.populateReferredEmails()}},{key:"populateReferredEmails",value:function(){this.customer.referrals.forEach(function(e){(0,s.default)(".swell-referral-history table tbody").append((0,s.default)("<tr>").append((0,s.default)("<td>").text(e.email),(0,s.default)("<td>").text(null===e.completedAt?"Invited":"Purchased ($10 earned)")))})}}]),e}();r.default=i},6:function(e,r){e.exports=window.jQuery}});